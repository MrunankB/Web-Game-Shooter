var sprites,particlePrefab,playerPrefab,bulletPrefab,enemyManagerPrefab,enemyPrefab,crosshairPrefab;class PlayerScript extends Component{constructor(){super();this.speed=200;this.shootRate=.1;this.shootTimer=0;this.health=100}Start(){this.gameObject.tag="Player";this.transform.scale=.6}Update(){var t=Input.GetMousePosition(),n=new Vector(0,0),i;n=t.subtract(this.transform.position);n=n.normalized();this.transform.rotation=n.toAngles().pi;i=Vector.max(n,t);this.shootTimer+=Time.deltaTime;this.shootTimer>=this.shootRate&&Input.GetMouseButtonDown("left")&&(this.Shoot(n),this.shootTimer=0);(Input.GetKey("left")||Input.GetKey("a"))&&(this.transform.position.x-=this.speed*Time.deltaTime);(Input.GetKey("right")||Input.GetKey("d"))&&(this.transform.position.x+=this.speed*Time.deltaTime);(Input.GetKey("up")||Input.GetKey("w"))&&(this.transform.position.y-=this.speed*Time.deltaTime);(Input.GetKey("down")||Input.GetKey("s"))&&(this.transform.position.y+=this.speed*Time.deltaTime);this.transform.position.x=Math.min(Math.max(this.transform.position.x,0),canvas.width-this.transform.scale);this.transform.position.y=Math.min(Math.max(this.transform.position.y,0),canvas.height-this.transform.scale)}Shoot(n){var r=new Vector(this.transform.position.x,this.transform.position.y),f=Input.GetMousePosition(),u=this.Instantiate(bulletPrefab),t=u.GetComponent(BulletScript),i;t!=null&&(t.transform.position=r,t.transform.rotation=this.transform.rotation,t.velocity=n);i=new Audio("resources/sounds/fire.wav");i.play()}OnCollisionEnter(n){console.log(n.name+" has collided with "+this.name)}}class EnemyManagerScript extends Component{constructor(){super();this.spawnRate=5;this.spawnTimer=0}Start(){}Update(){var n,i,t;this.transform.position.x+=.4*Time.deltaTime;this.spawnTimer+=Time.deltaTime;this.spawnTimer>=this.spawnRate&&(n=new Vector,n.x=random(0,canvas.width),n.y=random(0,canvas.height),i=this.Instantiate(enemyPrefab),t=i.GetComponent(EnemyScript),t!=null&&(t.transform.position=n,t.speed=random(50,80)),this.spawnTimer=0)}}class EnemyScript extends Component{constructor(n,t,i,r,u){super();this.name=n||"Enemy "+this.instanceId;this.speed=t||20;this.damage=i||1;this.attackRate=r||1;this.attackTimer=u||0}Start(){this.transform.scale=.4;this.gameObject.tag="Enemy"}Update(){var n=player.transform.position.subtract(this.transform.position);n=n.normalized();this.transform.rotation=n.toAngles().pi;this.transform.position.x+=n.x*this.speed*Time.deltaTime;this.transform.position.y+=n.y*this.speed*Time.deltaTime;this.attackTimer+=Time.deltaTime}OnCollisionStay(n){n.gameObject.tag=="Player"&&this.attackTimer>=this.attackRate&&(n.health-=this.damage,this.attackTimer=0)}}class BulletScript extends Component{constructor(){super();this.speed=1e3;this.velocity=new Vector;this.direction=new Vector(0,0)}Start(){this.transform.scale=.1}IsWithinBounds(){var n=this.transform.position;return n.x>=0&&n.x<=canvas.width&&n.y>=0&&n.y<=canvas.height?!0:(this.CreateExplosion(this.transform.position,2,40,"#525252"),this.CreateExplosion(this.transform.position,2,60,"#FFA318"),!1)}Update(){if(this.transform.position.x+=this.velocity.x*this.speed*Time.deltaTime,this.transform.position.y+=this.velocity.y*this.speed*Time.deltaTime,!this.IsWithinBounds()){var n=new Audio("resources/sounds/explosion.wav");n.play();this.Destroy(this.gameObject)}}OnCollisionStay(n){if(n.gameObject.tag=="Enemy"){var t=new Audio("resources/sounds/explosion.wav");t.play();this.Destroy(n.gameObject);this.Destroy(this.gameObject);this.CreateExplosion(n.transform.position,5,40,"#525252");this.CreateExplosion(n.transform.position,5,80,"#FFA318")}}CreateExplosion(n,t,i,r){for(var e,u,f=0;f<t;f++)e=GameObject.Instantiate(particlePrefab),u=e.GetComponent(ParticleScript),u.speed=i,u.color=r,u.transform.position=new Vector(n.x,n.y),u.velocity.x=random(-u.speed,u.speed),u.velocity.y=random(-u.speed,u.speed)}}class ParticleScript extends Component{constructor(){super();this.radius=20;this.scaleSpeed=1;this.speed=100;this.color="black"}Start(){this.transform.scale=1;this.velocity=new Vector(0,0)}Update(){this.transform.scale-=this.scaleSpeed*Time.deltaTime;this.transform.scale<=0&&this.Destroy(this.gameObject);this.transform.position.x+=this.velocity.x*Time.deltaTime;this.transform.position.y+=this.velocity.y*Time.deltaTime}Draw(){context.save();context.translate(this.transform.position.x,this.transform.position.y);context.scale(this.transform.scale,this.transform.scale);context.beginPath();context.fillStyle=this.color;context.arc(0,0,this.radius,0,Math.PI*2,!0);context.fill();context.closePath();context.restore()}}class CrosshairScript extends Component{constructor(){super();this.radius=30}Start(){$("body").css("cursor","none")}Update(){this.transform.position=Input.GetMousePosition()}Draw(){context.save();context.translate(this.transform.position.x,this.transform.position.y);context.scale(this.transform.scale,this.transform.scale);context.beginPath();context.strokeStyle=this.color;context.arc(0,0,this.radius,0,Math.PI*2);context.stroke();context.closePath();context.beginPath();context.fillStyle=this.color;context.arc(0,0,this.radius*.25,0,Math.PI*2);context.fill();context.closePath();context.restore()}}sprites=["default.png","laser.png","player.png"];particlePrefab=new GameObject;particlePrefab.AddComponent(new ParticleScript);playerPrefab=new GameObject;playerPrefab.name="Player";playerPrefab.tag="Player";playerPrefab.AddComponent(new SpriteRenderer("player.png"));playerPrefab.AddComponent(new BoxCollider);playerPrefab.AddComponent(new PlayerScript);bulletPrefab=new GameObject;bulletPrefab.AddComponent(new SpriteRenderer("default.png",100));bulletPrefab.AddComponent(new BulletScript);bulletPrefab.AddComponent(new BoxCollider);enemyManagerPrefab=new GameObject;enemyManagerPrefab.name="Enemy Manager";enemyManagerPrefab.AddComponent(new EnemyManagerScript);enemyPrefab=new GameObject;enemyPrefab.name="Enemy";enemyPrefab.tag="Enemy";enemyPrefab.color="red";enemyPrefab.AddComponent(new EnemyScript);enemyPrefab.AddComponent(new SpriteRenderer("player.png"));enemyPrefab.AddComponent(new BoxCollider);crosshairPrefab=new GameObject;crosshairPrefab.AddComponent(CrosshairScript);var player=GameObject.Instantiate(playerPrefab),enemyManager=GameObject.Instantiate(enemyManagerPrefab),crosshair=GameObject.Instantiate(crosshairPrefab);